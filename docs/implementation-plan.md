# Glimpse Implementation Plan

## Overview
This implementation plan breaks down the Glimpse app development into granular, actionable tasks optimized for AI coding agents. The plan follows a dependency-based approach, ensuring each task has the necessary context files available.

## Tech Stack
- **Frontend**: React Native (Expo)
- **Backend**: Convex
- **Language**: TypeScript
- **Additional**: React Navigation, Expo Camera, Expo Location, React Native Maps

## Implementation Tasks Table

| Task Name | Difficulty | Status | Context Relevant Files | Prompt |
|-----------|-----------|--------|----------------------|--------|
| **1. Initialize React Native Project** | Low | DONE | - PRD.md | Create a new React Native project using Expo with TypeScript support. Set up the basic folder structure with directories for: components/, screens/, services/, utils/, types/, and constants/. Put in the root of each folder a info.txt file that will contain a short description of what will be inside.Create a comprehensive .gitignore file. Configure TypeScript with strict mode enabled and path aliases for clean imports. |
| **2. Setup Convex Backend** | Low | DONE | - PRD.md<br>- package.json | Initialize Convex in the project and set up the backend structure. Create convex/ directory with schema.ts, functions/, and proper configuration. Install Convex npm packages and configure the development environment. Set up environment variables for Convex deployment URL and auth configuration. |
| **3. Define TypeScript Types** | Low | Planned | - PRD.md<br>- convex/schema.ts | Create comprehensive TypeScript type definitions in types/ directory. Define interfaces for User, Glimpse, Link, Focus, and all related entities based on the data models in the PRD. Include enums for focus types ('user' | 'place' | 'topic'), subscription tiers, and other constants. Ensure types match Convex schema exactly. |
| **4. Implement Convex Schema** | Medium | Planned | - PRD.md<br>- types/*.ts | Create the Convex database schema in convex/schema.ts. Define tables for users, glimpses, links, and focuses with all fields specified in the PRD. Set up proper indexes for efficient queries (username lookups, focus queries, timestamp ordering). Include validation rules and relationships between tables. |
| **5. Create Authentication System** | Medium | Planned | - convex/schema.ts<br>- types/User.ts<br>- package.json | Implement user authentication using Convex Auth. Create signup/login functions in convex/functions/auth.ts. Set up username validation (unique, alphanumeric, 3-20 chars). Create React Native screens for authentication flow with proper form validation. Store auth tokens securely using Expo SecureStore. |
| **6. Setup Navigation Structure** | Low | Planned | - App.tsx<br>- screens/<br>- types/ | Implement React Navigation with bottom tab navigator for main app flow. Create tab structure: Camera (default), Focus, Discover, Profile. Set up stack navigators within each tab for sub-screens. Configure deep linking and navigation types for TypeScript support. Ensure camera tab opens by default on app launch. |
| **7. Implement Camera Module** | Hard | Planned | - screens/CameraScreen.tsx<br>- types/Glimpse.ts<br>- utils/ | Create camera screen using Expo Camera API. Implement instant capture on tap with no preview. Add double-tap to switch cameras with smooth animation. Include subtle haptic feedback on capture using Expo Haptics. Handle camera permissions gracefully with user-friendly prompts. Optimize for minimal latency between tap and capture. |
| **8. Create Glimpse Upload Service** | Hard | Planned | - services/GlimpseService.ts<br>- convex/functions/glimpses.ts<br>- types/Glimpse.ts<br>- utils/imageCompression.ts | Implement instant upload system for captured photos. Create image compression utility to reduce file size while maintaining quality. Implement upload queue with offline support using AsyncStorage. Create Convex mutation for storing glimpse metadata and file upload. Show minimal, non-blocking upload progress indicator. Handle upload failures with automatic retry logic. |
| **9. Build Focus System Core** | Hard | Planned | - convex/functions/focus.ts<br>- types/Focus.ts<br>- services/FocusService.ts<br>- screens/FocusScreen.tsx | Implement the core focus system allowing users to focus on one entity at a time. Create Convex mutations for changing focus with proper validation. Implement real-time subscriptions for focus updates. Create UI for focus selection with search functionality. Add warning dialog before changing focus. Store focus history in database for Pro users. |
| **10. Implement Person Focus** | Medium | Planned | - screens/PersonFocusScreen.tsx<br>- convex/functions/users.ts<br>- components/UserSearch.tsx<br>- types/User.ts | Create user search functionality with debounced real-time results. Implement anonymous viewing of user's glimpses when focused. Create Convex query for fetching user's public glimpses in chronological order. Handle "someone focused on you" notifications (optional setting). Ensure privacy by not revealing viewer identity until mutual focus. |
| **11. Implement Place Focus** | Hard | Planned | - screens/PlaceFocusScreen.tsx<br>- components/MapView.tsx<br>- services/LocationService.ts<br>- convex/functions/places.ts | Integrate React Native Maps for place selection. Implement geofencing logic with customizable radius. Create location permission handling with fallback options. Implement Convex queries for glimpses within geographic boundaries. Add popular places suggestion algorithm based on glimpse density. Handle location updates efficiently to preserve battery. |
| **12. Implement Topic Focus** | Medium | Planned | - screens/TopicFocusScreen.tsx<br>- components/TopicSearch.tsx<br>- convex/functions/topics.ts<br>- utils/hashtag.ts | Create hashtag parsing system for glimpse captions. Implement topic search with autocomplete suggestions. Create trending algorithm based on recent usage. Build global feed query for topic-tagged glimpses. Ensure efficient indexing for hashtag queries. Add topic following history for Pro users. |
| **13. Create Link Detection System** | Hard | Planned | - convex/functions/links.ts<br>- services/LinkService.ts<br>- types/Link.ts<br>- utils/realtimeSubscription.ts | Implement real-time mutual focus detection using Convex subscriptions. Create efficient algorithm to detect when two users focus on each other. Trigger link formation with celebratory animation and haptic feedback. Store link history with timestamps. Implement link breaking when either user changes focus. Set up real-time notifications for link events. |
| **14. Build Private Glimpse Exchange** | Medium | Planned | - screens/LinkChatScreen.tsx<br>- components/GlimpseMessage.tsx<br>- convex/functions/privateGlimpses.ts<br>- types/Link.ts | Create private communication channel for linked users. Implement special glimpse type for private exchanges. Build chat-like UI with visual conversation thread. Add 24-hour auto-deletion for link glimpses. Ensure end-to-end encryption for private content. Create smooth transition from public to private glimpse viewing. |
| **15. Implement Discovery System** | Medium | Planned | - screens/DiscoverScreen.tsx<br>- components/TrendingTopics.tsx<br>- components/PopularPlaces.tsx<br>- convex/functions/discovery.ts | Build explore section showing trending topics (names only, no preview). Create heat map visualization for popular places. Implement focus suggestions based on user history. Ensure no content preview to maintain focus principle. Add smart recommendation algorithm considering time, location, and interests. |
| **16. Create Notification System** | Medium | Planned | - services/NotificationService.ts<br>- convex/functions/notifications.ts<br>- utils/pushNotifications.ts<br>- types/Notification.ts | Implement push notifications using Expo Notifications API. Create notification types for links, focuses, and system messages. Build in-app notification center with read/unread states. Implement notification preferences per notification type. Ensure notifications work in background and killed app states. Add smart batching to prevent notification spam. |
| **17. Build Profile Management** | Low | Planned | - screens/ProfileScreen.tsx<br>- components/ProfileSettings.tsx<br>- convex/functions/profile.ts<br>- types/User.ts | Create user profile screen with settings and stats. Display link history and current focus. Implement subscription management UI for Pro features. Add privacy controls and notification preferences. Create account deletion flow with data export option. Show trust score for moderation transparency. |
| **18. Implement Content Moderation** | Hard | Planned | - services/ModerationService.ts<br>- convex/functions/moderation.ts<br>- utils/aiModeration.ts<br>- components/ReportDialog.tsx | Integrate AI-based content screening before upload completion. Implement progressive trust system based on user behavior. Create reporting UI with category selection. Build automated takedown system after threshold reports. Implement appeal process for false positives. Add admin dashboard for moderation review. |
| **19. Add Offline Support** | Medium | Planned | - services/OfflineQueue.ts<br>- utils/connectivity.ts<br>- utils/asyncStorage.ts<br>- types/QueuedGlimpse.ts | Implement robust offline queue for glimpse uploads. Create connection monitoring service. Store captured glimpses locally when offline. Implement smart upload retry with exponential backoff. Show offline indicator in UI. Sync focus changes when connection restored. Ensure data consistency between local and remote state. |
| **20. Implement Pro Features** | Medium | Planned | - screens/ProFeaturesScreen.tsx<br>- services/SubscriptionService.ts<br>- convex/functions/subscriptions.ts<br>- components/ProBadge.tsx | Build subscription management using platform-specific IAP. Implement focus history with quick switching UI. Create traces system showing who left a focus. Enable 3-second glimpses for Pro users. Add nested focus capability (Person + Place/Topic). Implement extended link storage beyond 24 hours. |
| **21. Create Onboarding Flow** | Low | Planned | - screens/OnboardingScreens.tsx<br>- components/OnboardingSlides.tsx<br>- utils/firstTimeUser.ts<br>- assets/illustrations/ | Design engaging 3-screen philosophy explanation. Create smooth animations between onboarding steps. Implement permission requests with clear explanations. Guide first focus selection (friend, place, or #welcome). Prompt for first glimpse capture. Store onboarding completion state. Make onboarding skippable but accessible from settings. |
| **22. Performance Optimization** | Hard | Planned | - All components<br>- services/*<br>- utils/performance.ts<br>- convex/functions/* | Implement React Native performance best practices. Optimize image loading with lazy loading and caching. Implement FlatList optimizations for feed scrolling. Add memory management for camera and images. Profile and optimize Convex queries. Implement code splitting and lazy loading. Monitor and optimize app startup time. |
| **23. Implement Analytics** | Medium | Planned | - services/AnalyticsService.ts<br>- utils/metrics.ts<br>- convex/functions/analytics.ts<br>- types/Analytics.ts | Set up analytics tracking for key metrics (DAF, focus duration, links formed). Implement privacy-respecting event tracking. Create dashboards for business metrics. Track performance metrics (upload time, focus switch latency). Set up error tracking and crash reporting. Implement A/B testing framework for feature experiments. |
| **24. Security Hardening** | Hard | Planned | - All services<br>- convex/functions/*<br>- utils/encryption.ts<br>- utils/validation.ts | Implement input validation across all user inputs. Add rate limiting for API calls and uploads. Encrypt sensitive data in transit and at rest. Implement secure token management. Add protection against common attacks (XSS, injection). Audit third-party dependencies for vulnerabilities. Implement certificate pinning for API calls. |
| **25. Testing Suite Setup** | Medium | Planned | - __tests__/*<br>- jest.config.js<br>- All components<br>- All services | Set up Jest and React Native Testing Library. Write unit tests for all utilities and services. Create integration tests for Convex functions. Implement snapshot tests for components. Add E2E tests using Detox. Set up CI/CD pipeline with automated testing. Achieve minimum 80% code coverage. |
| **26. Localization Setup** | Low | Planned | - utils/i18n.ts<br>- locales/*<br>- All screens<br>- All components | Implement i18n framework using react-i18next. Extract all strings to translation files. Create language selection in settings. Support RTL languages properly. Implement date/time localization. Add placeholder for future language additions. Test with at least 3 languages initially. |
| **27. Beta Release Preparation** | Medium | Planned | - All previous tasks<br>- deployment/*<br>- docs/*<br>- marketing/assets/* | Create beta testing program with TestFlight/Play Console. Implement feature flags for gradual rollout. Set up crash reporting and monitoring. Create feedback collection system. Prepare app store assets and descriptions. Implement version checking and force update capability. Create beta user onboarding materials. |
| **28. Business Account Features** | Medium | Planned | - screens/BusinessDashboard.tsx<br>- convex/functions/business.ts<br>- components/VenueProfile.tsx<br>- types/Business.ts | Create separate business account registration flow. Implement venue profile management. Build focus analytics dashboard for businesses. Create pinned glimpse feature for welcome messages. Implement verified badge system. Add API access management for integrations. Create billing system for business tier. |
| **29. Focus Events Platform** | Hard | Planned | - screens/FocusEvents.tsx<br>- convex/functions/events.ts<br>- services/EventService.ts<br>- components/EventDiscovery.tsx | Design focus events creation interface for businesses. Implement time-limited event focus system. Create discovery mechanism for public events. Build participant tracking and special badges. Implement revenue sharing calculation. Add event analytics and reporting. Create event moderation workflow. |
| **30. Production Deployment** | Medium | Planned | - All previous tasks<br>- deployment/production/*<br>- monitoring/*<br>- docs/runbook.md | Set up production Convex deployment. Configure CDN for global image delivery. Implement monitoring and alerting system. Create deployment rollback procedures. Set up database backup strategy. Implement gradual rollout system. Create operational runbooks. Establish 24/7 monitoring protocols. |

## Development Phases

### Phase 1: Foundation (Tasks 1-8)
Core infrastructure, authentication, and basic glimpse capture

### Phase 2: Focus System (Tasks 9-12)
Complete focus implementation with all three types

### Phase 3: Social Features (Tasks 13-17)
Links, private messaging, discovery, and profiles

### Phase 4: Quality & Safety (Tasks 18-24)
Moderation, offline support, performance, and security

### Phase 5: Polish & Launch (Tasks 25-30)
Testing, localization, beta prep, and advanced features

## Key Dependencies
- Each task builds upon previous ones in its phase
- Convex schema must be finalized before implementing features
- Camera and upload must work before focus system
- Focus system required before links can be implemented
- Core features needed before Pro/Business features

## Success Criteria
- All tasks completed with "Done" status
- 80%+ test coverage achieved
- Performance metrics meet PRD requirements
- Beta user feedback incorporated
- Security audit passed
- App store approval obtained